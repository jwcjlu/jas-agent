# Generated with protoc-gen-openapi
# https://github.com/google/gnostic/tree/master/cmd/protoc-gen-openapi

openapi: 3.0.3
info:
    title: AgentService API
    description: Agent服务定义（Kratos风格）
    version: 0.0.1
paths:
    /api/agent-types:
        get:
            tags:
                - AgentService
            description: 获取可用的Agent类型
            operationId: AgentService_ListAgentTypes
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentTypesResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/agents:
        get:
            tags:
                - AgentService
            operationId: AgentService_ListAgents
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentListResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
        post:
            tags:
                - AgentService
            description: Agent 管理
            operationId: AgentService_CreateAgent
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/AgentConfigRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentConfigResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/agents/{id}:
        get:
            tags:
                - AgentService
            operationId: AgentService_GetAgent
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentConfigResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
        put:
            tags:
                - AgentService
            operationId: AgentService_UpdateAgent
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/AgentConfigRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentConfigResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
        delete:
            tags:
                - AgentService
            operationId: AgentService_DeleteAgent
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/AgentConfigResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/chat:
        post:
            tags:
                - AgentService
            description: 单次对话请求
            operationId: AgentService_Chat
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/ChatRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ChatResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/chat/stream:
        post:
            tags:
                - AgentService
            description: 流式对话请求
            operationId: AgentService_StreamChat
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/ChatRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ChatStreamResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/mcp/services:
        get:
            tags:
                - AgentService
            operationId: AgentService_ListMCPServices
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MCPServicesResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
        post:
            tags:
                - AgentService
            description: MCP 服务管理
            operationId: AgentService_AddMCPService
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/MCPServiceRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MCPServiceResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/mcp/services-with-id:
        get:
            tags:
                - AgentService
            operationId: AgentService_ListMCPServicesWithId
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MCPServicesWithIdResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/mcp/services/{id}/tools:
        get:
            tags:
                - AgentService
            operationId: AgentService_GetMCPServiceTools
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MCPServiceToolsResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/mcp/services/{name}:
        delete:
            tags:
                - AgentService
            operationId: AgentService_RemoveMCPService
            parameters:
                - name: name
                  in: path
                  required: true
                  schema:
                    type: string
                - name: endpoint
                  in: query
                  schema:
                    type: string
                - name: clientType
                  in: query
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MCPServiceResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
    /api/tools:
        get:
            tags:
                - AgentService
            description: 获取可用的工具列表
            operationId: AgentService_ListTools
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ToolsResponse'
                default:
                    description: Default error response
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Status'
components:
    schemas:
        AgentConfig:
            type: object
            properties:
                id:
                    type: integer
                    format: int32
                name:
                    type: string
                framework:
                    type: string
                description:
                    type: string
                systemPrompt:
                    type: string
                maxSteps:
                    type: integer
                    format: int32
                model:
                    type: string
                mcpServices:
                    type: array
                    items:
                        type: string
                createdAt:
                    type: string
                updatedAt:
                    type: string
                isActive:
                    type: boolean
                connectionConfig:
                    type: string
                configJson:
                    type: string
            description: Agent 配置信息
        AgentConfigRequest:
            type: object
            properties:
                id:
                    type: integer
                    format: int32
                name:
                    type: string
                framework:
                    type: string
                description:
                    type: string
                systemPrompt:
                    type: string
                maxSteps:
                    type: integer
                    format: int32
                model:
                    type: string
                mcpServices:
                    type: array
                    items:
                        type: string
                config:
                    type: object
                    additionalProperties:
                        type: string
                connectionConfig:
                    type: string
                configJson:
                    type: string
            description: Agent 配置请求
        AgentConfigResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                agent:
                    $ref: '#/components/schemas/AgentConfig'
            description: Agent 配置响应
        AgentListResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                agents:
                    type: array
                    items:
                        $ref: '#/components/schemas/AgentConfig'
            description: Agent 列表响应
        AgentTypeInfo:
            type: object
            properties:
                type:
                    type: integer
                    format: enum
                name:
                    type: string
                description:
                    type: string
                available:
                    type: boolean
            description: Agent类型信息
        AgentTypesResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                types:
                    type: array
                    items:
                        $ref: '#/components/schemas/AgentTypeInfo'
            description: Agent类型列表响应
        BaseResponse:
            type: object
            properties:
                code:
                    type: integer
                    format: int32
                message:
                    type: string
                reason:
                    type: string
        ChatRequest:
            type: object
            properties:
                query:
                    type: string
                agentId:
                    type: integer
                    format: int32
                sessionId:
                    type: string
                agentType:
                    type: integer
                    description: 以下字段用于临时覆盖Agent配置（可选）
                    format: enum
                model:
                    type: string
                systemPrompt:
                    type: string
                maxSteps:
                    type: integer
                    format: int32
                config:
                    type: object
                    additionalProperties:
                        type: string
                enabledMcpServices:
                    type: array
                    items:
                        type: string
            description: 对话请求
        ChatResponse:
            type: object
            properties:
                response:
                    type: string
                agentType:
                    type: string
                metadata:
                    $ref: '#/components/schemas/ExecutionMetadata'
                ret:
                    $ref: '#/components/schemas/BaseResponse'
            description: 对话响应
        ChatStreamResponse:
            type: object
            properties:
                type:
                    type: integer
                    format: enum
                content:
                    type: string
                step:
                    type: integer
                    format: int32
                metadata:
                    $ref: '#/components/schemas/ExecutionMetadata'
            description: 流式对话响应
        ExecutionMetadata:
            type: object
            properties:
                totalSteps:
                    type: integer
                    format: int32
                toolsCalled:
                    type: integer
                    format: int32
                toolNames:
                    type: array
                    items:
                        type: string
                executionTimeMs:
                    type: string
                state:
                    type: string
            description: 执行元数据
        GoogleProtobufAny:
            type: object
            properties:
                '@type':
                    type: string
                    description: The type of the serialized message.
            additionalProperties: true
            description: Contains an arbitrary serialized message along with a @type that describes the type of the serialized message.
        MCPServiceInfo:
            type: object
            properties:
                name:
                    type: string
                endpoint:
                    type: string
                active:
                    type: boolean
                toolCount:
                    type: integer
                    format: int32
                createdAt:
                    type: string
                lastRefresh:
                    type: string
            description: MCP 服务信息
        MCPServiceRequest:
            type: object
            properties:
                name:
                    type: string
                endpoint:
                    type: string
                clientType:
                    type: string
            description: MCP 服务请求
        MCPServiceResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                service:
                    $ref: '#/components/schemas/MCPServiceInfo'
            description: MCP 服务响应
        MCPServiceToolInfo:
            type: object
            properties:
                name:
                    type: string
                description:
                    type: string
                type:
                    type: string
                inputSchema:
                    type: object
        MCPServiceToolsResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                tools:
                    type: array
                    items:
                        $ref: '#/components/schemas/MCPServiceToolInfo'
        MCPServiceWithIdInfo:
            type: object
            properties:
                id:
                    type: integer
                    format: int32
                name:
                    type: string
                endpoint:
                    type: string
                active:
                    type: boolean
                toolCount:
                    type: integer
                    format: int32
                description:
                    type: string
                createdAt:
                    type: string
                lastRefresh:
                    type: string
                clientType:
                    type: string
        MCPServicesResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                services:
                    type: array
                    items:
                        $ref: '#/components/schemas/MCPServiceInfo'
            description: MCP 服务列表响应
        MCPServicesWithIdResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                services:
                    type: array
                    items:
                        $ref: '#/components/schemas/MCPServiceWithIdInfo'
        Status:
            type: object
            properties:
                code:
                    type: integer
                    description: The status code, which should be an enum value of [google.rpc.Code][google.rpc.Code].
                    format: int32
                message:
                    type: string
                    description: A developer-facing error message, which should be in English. Any user-facing error message should be localized and sent in the [google.rpc.Status.details][google.rpc.Status.details] field, or localized by the client.
                details:
                    type: array
                    items:
                        $ref: '#/components/schemas/GoogleProtobufAny'
                    description: A list of messages that carry the error details.  There is a common set of message types for APIs to use.
            description: 'The `Status` type defines a logical error model that is suitable for different programming environments, including REST APIs and RPC APIs. It is used by [gRPC](https://github.com/grpc). Each `Status` message contains three pieces of data: error code, error message, and error details. You can find out more about this error model and how to work with it in the [API Design Guide](https://cloud.google.com/apis/design/errors).'
        ToolInfo:
            type: object
            properties:
                name:
                    type: string
                description:
                    type: string
                type:
                    type: string
                mcpService:
                    type: string
            description: 工具信息
        ToolsResponse:
            type: object
            properties:
                ret:
                    $ref: '#/components/schemas/BaseResponse'
                tools:
                    type: array
                    items:
                        $ref: '#/components/schemas/ToolInfo'
            description: 工具列表响应
tags:
    - name: AgentService
