# Elasticsearch ç´¢å¼•æ™ºèƒ½æŸ¥æ‰¾åŠŸèƒ½è¯´æ˜

## ğŸ¯ æ–°å¢åŠŸèƒ½

ä¸º Elasticsearch Agent æ·»åŠ äº†**æ™ºèƒ½ç´¢å¼•æŸ¥æ‰¾**åŠŸèƒ½ï¼Œè§£å†³ç´¢å¼•åç§°ä¸ç¡®å®šæ—¶çš„æŸ¥è¯¢é—®é¢˜ã€‚

---

## âœ¨ æ ¸å¿ƒæ”¹è¿›

### 1. âœ… æ–°å¢ `search_indices` å·¥å…·

**åŠŸèƒ½**: æ ¹æ®å…³é”®è¯æ¨¡ç³Šæœç´¢ç´¢å¼•åç§°

**ä½¿ç”¨åœºæ™¯**:
- ä¸ç¡®å®šç´¢å¼•çš„å®Œæ•´åç§°
- éœ€è¦æŸ¥æ‰¾åŒ…å«ç‰¹å®šå…³é”®è¯çš„ç´¢å¼•
- æ¢ç´¢é›†ç¾¤ä¸­çš„ç´¢å¼•ç»“æ„

**ç¤ºä¾‹**:
```
Action: search_indices[log]
è¿”å›: 
  - logs-2024-11
  - logs-2024-10
  - application-logs

Action: search_indices[backend]
è¿”å›:
  - backend-vm_manager-2025.11.04
  - backend-api-2025.11.03
```

### 2. âœ… å‹å¥½çš„é”™è¯¯æç¤º

å½“ç´¢å¼•ä¸å­˜åœ¨æ—¶ï¼Œè‡ªåŠ¨æä¾›æ™ºèƒ½å»ºè®®ï¼š

**get_index_mapping**:
```
é”™è¯¯: ç´¢å¼• 'logs' ä¸å­˜åœ¨ã€‚
å»ºè®®: å…ˆä½¿ç”¨ list_indices å·¥å…·æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ç´¢å¼•ï¼Œç„¶åé€‰æ‹©æ­£ç¡®çš„ç´¢å¼•åç§°
```

**search_documents**:
```
é”™è¯¯: ç´¢å¼• 'logs' ä¸å­˜åœ¨ã€‚
å»ºè®®: å…ˆä½¿ç”¨ list_indices å·¥å…·æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ç´¢å¼•ï¼Œæˆ–ä½¿ç”¨é€šé…ç¬¦æ¨¡å¼å¦‚ 'logs-*'
```

### 3. âœ… ç³»ç»Ÿæç¤ºè¯ä¼˜åŒ–

**æ–°å¢ç´¢å¼•æŸ¥æ‰¾ç­–ç•¥**:
```
ç´¢å¼•æŸ¥æ‰¾ç­–ç•¥:
  - å¦‚æœä¸ç¡®å®šç´¢å¼•çš„å®Œæ•´åç§°ï¼Œå…ˆä½¿ç”¨ search_indices æ¨¡ç³ŠæŸ¥æ‰¾
  - å½“å·¥å…·è¿”å›"ç´¢å¼•ä¸å­˜åœ¨"é”™è¯¯æ—¶ï¼Œç«‹å³ä½¿ç”¨ list_indices æˆ– search_indices æŸ¥æ‰¾æ­£ç¡®çš„ç´¢å¼•
  - ç´¢å¼•åç§°é€šå¸¸åŒ…å«æ—¥æœŸã€é¡¹ç›®åã€ç¯å¢ƒç­‰ä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®è¿™äº›å…³é”®è¯æœç´¢
  - æ”¯æŒä½¿ç”¨é€šé…ç¬¦ï¼ˆå¦‚ logs-* åŒ¹é…æ‰€æœ‰ä»¥ logs- å¼€å¤´çš„ç´¢å¼•ï¼‰
```

**æ–°å¢ç¤ºä¾‹**:
```
ç¤ºä¾‹ 1: æŸ¥æ‰¾æ—¥å¿—ç›¸å…³ç´¢å¼•
  Thought: æˆ‘éœ€è¦å…ˆæŸ¥æ‰¾æ—¥å¿—ç›¸å…³çš„ç´¢å¼•
  Action: search_indices[log]

ç¤ºä¾‹ 2: æŸ¥æ‰¾backendç›¸å…³ç´¢å¼•
  Thought: ç”¨æˆ·æåˆ°backendï¼Œæˆ‘éœ€è¦å…ˆæ‰¾åˆ°backendç›¸å…³çš„ç´¢å¼•
  Action: search_indices[backend]
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### search_indices å·¥å…· (`tools/es_index_search.go`)

```go
type SearchIndices struct {
    conn *ESConnection
}

func (t *SearchIndices) Handler(ctx context.Context, input string) (string, error) {
    keyword := strings.ToLower(strings.TrimSpace(input))
    
    // 1. è·å–æ‰€æœ‰ç´¢å¼•
    respBody := t.conn.doRequest(ctx, "GET", "/_cat/indices?v&format=json", nil)
    
    // 2. è§£æç´¢å¼•åˆ—è¡¨
    var indices []map[string]interface{}
    json.Unmarshal(respBody, &indices)
    
    // 3. æ¨¡ç³ŠåŒ¹é…
    var matchedIndices []map[string]interface{}
    for _, index := range indices {
        indexName := index["index"]
        if strings.Contains(strings.ToLower(indexName), keyword) {
            matchedIndices = append(matchedIndices, index)
        }
    }
    
    // 4. è¿”å›ç»“æœ
    if len(matchedIndices) == 0 {
        return "æœªæ‰¾åˆ°åŒ…å«å…³é”®è¯çš„ç´¢å¼•ï¼Œå»ºè®®ä½¿ç”¨ list_indices æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•"
    }
    
    return "æ‰¾åˆ°åŒ¹é…çš„ç´¢å¼•ï¼š\n- index1\n- index2\n..."
}
```

**ç‰¹ç‚¹**:
- âœ… å¤§å°å†™ä¸æ•æ„ŸåŒ¹é…
- âœ… éƒ¨åˆ†åŒ¹é…ï¼ˆåŒ…å«å³å¯ï¼‰
- âœ… è¿”å›å¥åº·çŠ¶æ€ã€æ–‡æ¡£æ•°ã€å¤§å°ç­‰ä¿¡æ¯
- âœ… å‹å¥½çš„æç¤ºä¿¡æ¯

---

## ğŸ“Š ä½¿ç”¨åœºæ™¯æ¼”ç¤º

### åœºæ™¯ 1: ä¸ç¡®å®šç´¢å¼•åç§°

**ç”¨æˆ·æŸ¥è¯¢**: "æŸ¥æ‰¾backendé¡¹ç›®çš„é”™è¯¯æ—¥å¿—"

**Agent æ‰§è¡Œæµç¨‹**:
```
ğŸ’­ Thought: ç”¨æˆ·æåˆ°backendï¼Œæˆ‘éœ€è¦å…ˆæ‰¾åˆ°ç›¸å…³çš„ç´¢å¼•
âš™ï¸ Action: search_indices[backend]
ğŸ‘ï¸ Observation: 
  æ‰¾åˆ° 2 ä¸ªåŒ…å«å…³é”®è¯ 'backend' çš„ç´¢å¼•ï¼š
  - backend-vm_manager-2025.11.04
    Health: green, Docs: 15234, Size: 2.3mb
  - backend-api-2025.11.03
    Health: green, Docs: 8567, Size: 1.2mb

ğŸ’­ Thought: æ‰¾åˆ°äº†ç›¸å…³ç´¢å¼•ï¼Œç°åœ¨æŸ¥çœ‹ç»“æ„
âš™ï¸ Action: get_index_mapping[backend-vm_manager-2025.11.04]
ğŸ‘ï¸ Observation: å­—æ®µæ˜ å°„...

ğŸ’­ Thought: æ„å»ºæœç´¢æŸ¥è¯¢
âš™ï¸ Action: search_documents[{
  "index": "backend-vm_manager-2025.11.04",
  "query": {
    "term": {"L.keyword": "ERROR"}
  }
}]
ğŸ‘ï¸ Observation: æ‰¾åˆ° X æ¡é”™è¯¯æ—¥å¿—...

ğŸ“Š æœ€ç»ˆç­”æ¡ˆ: åœ¨ backend-vm_manager é¡¹ç›®ä¸­æ‰¾åˆ° X æ¡é”™è¯¯æ—¥å¿—...
```

### åœºæ™¯ 2: ç´¢å¼•ä¸å­˜åœ¨çš„æ™ºèƒ½æ¢å¤

**ç”¨æˆ·æŸ¥è¯¢**: "æœç´¢logsç´¢å¼•çš„é”™è¯¯"

**Agent æ‰§è¡Œæµç¨‹**:
```
ğŸ’­ Thought: ç”¨æˆ·æƒ³æœç´¢logsç´¢å¼•
âš™ï¸ Action: get_index_mapping[logs]
ğŸ‘ï¸ Observation: âŒ é”™è¯¯ï¼šç´¢å¼• 'logs' ä¸å­˜åœ¨ã€‚
               å»ºè®®ï¼šå…ˆä½¿ç”¨ list_indices å·¥å…·æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ç´¢å¼•

ğŸ’­ Thought: ç´¢å¼•ä¸å­˜åœ¨ï¼Œæˆ‘éœ€è¦æŸ¥æ‰¾æ—¥å¿—ç›¸å…³çš„ç´¢å¼•
âš™ï¸ Action: search_indices[log]                    â† è‡ªåŠ¨æ¢å¤
ğŸ‘ï¸ Observation: 
  æ‰¾åˆ° 3 ä¸ªåŒ…å«å…³é”®è¯ 'log' çš„ç´¢å¼•ï¼š
  - logs-2024-11
  - logs-2024-10
  - application-logs

ğŸ’­ Thought: æœ€æ–°çš„æ—¥å¿—ç´¢å¼•æ˜¯ logs-2024-11
âš™ï¸ Action: search_documents[{
  "index": "logs-2024-11",
  "query": {"term": {"level.keyword": "ERROR"}}
}]
ğŸ‘ï¸ Observation: æ‰¾åˆ°é”™è¯¯æ—¥å¿—...
```

### åœºæ™¯ 3: æ—¥æœŸç›¸å…³ç´¢å¼•æŸ¥æ‰¾

**ç”¨æˆ·æŸ¥è¯¢**: "æŸ¥çœ‹11æœˆçš„æ—¥å¿—"

**Agent æ‰§è¡Œæµç¨‹**:
```
ğŸ’­ Thought: éœ€è¦æŸ¥æ‰¾11æœˆçš„æ—¥å¿—ç´¢å¼•
âš™ï¸ Action: search_indices[2024-11]
ğŸ‘ï¸ Observation:
  æ‰¾åˆ° 5 ä¸ªåŒ…å«å…³é”®è¯ '2024-11' çš„ç´¢å¼•ï¼š
  - logs-2024-11
  - backend-vm_manager-2025.11.04
  - api-logs-2024-11-05
  - user-events-2024-11
  - metrics-2024-11

ğŸ’­ Thought: æ‰¾åˆ°äº†å¤šä¸ª11æœˆçš„ç´¢å¼•ï¼Œå¯ä»¥è¿›ä¸€æ­¥æŸ¥è¯¢...
```

---

## ğŸ¯ å·¥å…·å¯¹æ¯”

### ES å·¥å…·é›†ï¼ˆç°åœ¨å…±6ä¸ªï¼‰

| å·¥å…· | åŠŸèƒ½ | è¾“å…¥ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| `list_indices` | åˆ—å‡ºæ‰€æœ‰ç´¢å¼• | æ—  | æŸ¥çœ‹é›†ç¾¤å…¨è²Œ |
| **`search_indices`** | æ¨¡ç³Šæœç´¢ç´¢å¼• | å…³é”®è¯ | **ä¸ç¡®å®šç´¢å¼•åç§°** â­ |
| `get_index_mapping` | è·å–ç´¢å¼•æ˜ å°„ | ç´¢å¼•å | äº†è§£å­—æ®µç»“æ„ |
| `search_documents` | æœç´¢æ–‡æ¡£ | JSONæŸ¥è¯¢ | æŸ¥æ‰¾æ•°æ® |
| `get_document` | è·å–æ–‡æ¡£ | index+id | ç²¾ç¡®æŸ¥è¯¢ |
| `aggregate_data` | èšåˆåˆ†æ | JSONèšåˆ | æ•°æ®ç»Ÿè®¡ |

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: æŒ‰å…³é”®è¯æŸ¥æ‰¾

```
ç”¨æˆ·: "æŸ¥æ‰¾æ—¥å¿—ç›¸å…³çš„ç´¢å¼•"

Action: search_indices[log]

ç»“æœ:
  æ‰¾åˆ° 3 ä¸ªåŒ…å«å…³é”®è¯ 'log' çš„ç´¢å¼•ï¼š
  - application-logs
    Health: green, Docs: 50000, Size: 10mb
  - error-logs-2024-11
    Health: green, Docs: 1234, Size: 500kb
  - access-logs
    Health: yellow, Docs: 100000, Size: 25mb
```

### ç¤ºä¾‹ 2: æŒ‰æ—¥æœŸæŸ¥æ‰¾

```
ç”¨æˆ·: "æŸ¥æ‰¾11æœˆ4å·çš„ç´¢å¼•"

Action: search_indices[11.04]

ç»“æœ:
  æ‰¾åˆ° 2 ä¸ªåŒ…å«å…³é”®è¯ '11.04' çš„ç´¢å¼•ï¼š
  - backend-vm_manager-2025.11.04
  - frontend-logs-2025.11.04
```

### ç¤ºä¾‹ 3: æŒ‰é¡¹ç›®åæŸ¥æ‰¾

```
ç”¨æˆ·: "æŸ¥æ‰¾vm_managerç›¸å…³çš„ç´¢å¼•"

Action: search_indices[vm_manager]

ç»“æœ:
  æ‰¾åˆ° 1 ä¸ªåŒ…å«å…³é”®è¯ 'vm_manager' çš„ç´¢å¼•ï¼š
  - backend-vm_manager-2025.11.04
    Health: green, Docs: 15234, Size: 2.3mb
```

---

## ğŸ¤– Agent æ™ºèƒ½è¡Œä¸º

### ç­–ç•¥ 1: ä¸»åŠ¨æ¨¡ç³ŠæŸ¥æ‰¾

å½“ç”¨æˆ·æè¿°ä¸ç²¾ç¡®æ—¶ï¼š
```
ç”¨æˆ·: "æŸ¥çœ‹åå°æœåŠ¡çš„æ—¥å¿—"

Agent:
  Thought: "åå°æœåŠ¡"ä¸æ˜¯ç²¾ç¡®çš„ç´¢å¼•åï¼Œæˆ‘éœ€è¦æœç´¢ç›¸å…³ç´¢å¼•
  Action: search_indices[backend]  â† è‡ªåŠ¨ä½¿ç”¨æ¨¡ç³ŠæŸ¥æ‰¾
```

### ç­–ç•¥ 2: é”™è¯¯æ¢å¤

å½“é‡åˆ°ç´¢å¼•ä¸å­˜åœ¨é”™è¯¯æ—¶ï¼š
```
Action: get_index_mapping[logs]
Observation: é”™è¯¯ - ç´¢å¼•ä¸å­˜åœ¨ï¼Œå»ºè®®ä½¿ç”¨ list_indices

Agent:
  Thought: ç´¢å¼•ä¸å­˜åœ¨ï¼Œæˆ‘éœ€è¦æŸ¥æ‰¾æ­£ç¡®çš„ç´¢å¼•
  Action: search_indices[log]      â† è‡ªåŠ¨æ¢å¤
```

### ç­–ç•¥ 3: å¤šç´¢å¼•æ¢ç´¢

å½“åŒ¹é…åˆ°å¤šä¸ªç´¢å¼•æ—¶ï¼š
```
Action: search_indices[2024-11]
Observation: æ‰¾åˆ° 5 ä¸ªç´¢å¼•

Agent:
  Thought: æœ‰å¤šä¸ª11æœˆçš„ç´¢å¼•ï¼Œæ ¹æ®ç”¨æˆ·éœ€æ±‚é€‰æ‹©æœ€ç›¸å…³çš„
  - å¦‚æœæ˜¯æ—¥å¿— â†’ é€‰æ‹© logs-2024-11
  - å¦‚æœæ˜¯äº‹ä»¶ â†’ é€‰æ‹© events-2024-11
```

---

## ğŸ“Š å®Œæ•´å·¥å…·åˆ—è¡¨

### Elasticsearch Agent ç°æœ‰å·¥å…·

```
1. list_indices      - åˆ—å‡ºæ‰€æœ‰ç´¢å¼•ï¼ˆå…¨å±€è§†å›¾ï¼‰
2. search_indices    - æ¨¡ç³Šæœç´¢ç´¢å¼•ï¼ˆæ™ºèƒ½æŸ¥æ‰¾ï¼‰â­ æ–°å¢
3. get_index_mapping - è·å–ç´¢å¼•æ˜ å°„ï¼ˆç»“æ„æŸ¥çœ‹ï¼‰
4. search_documents  - æœç´¢æ–‡æ¡£ï¼ˆæ•°æ®æŸ¥è¯¢ï¼‰
5. get_document      - è·å–æ–‡æ¡£ï¼ˆç²¾ç¡®æŸ¥æ‰¾ï¼‰
6. aggregate_data    - èšåˆåˆ†æï¼ˆæ•°æ®ç»Ÿè®¡ï¼‰
```

---

## ğŸ”„ å·¥ä½œæµç¨‹å¯¹æ¯”

### ä¼˜åŒ–å‰

```
ç”¨æˆ·: "æŸ¥æ‰¾backendçš„é”™è¯¯æ—¥å¿—"
  â†“
Agent: å‡è®¾ç´¢å¼•åæ˜¯ backend
  â†“
Action: search_documents[{"index": "backend", ...}]
  â†“
âŒ é”™è¯¯: ç´¢å¼•ä¸å­˜åœ¨
  â†“
éœ€è¦ç”¨æˆ·æ‰‹åŠ¨æä¾›æ­£ç¡®çš„ç´¢å¼•å
```

### ä¼˜åŒ–å

```
ç”¨æˆ·: "æŸ¥æ‰¾backendçš„é”™è¯¯æ—¥å¿—"
  â†“
Agent: å…ˆæœç´¢ç›¸å…³ç´¢å¼•
  â†“
Action: search_indices[backend]      â† æ™ºèƒ½æŸ¥æ‰¾
  â†“
Observation: backend-vm_manager-2025.11.04
  â†“
Action: search_documents[{"index": "backend-vm_manager-2025.11.04", ...}]
  â†“
âœ… æˆåŠŸè¿”å›ç»“æœï¼
```

---

## ğŸ“ ç³»ç»Ÿæç¤ºè¯æ›´æ–°

### æ–°å¢çš„æŒ‡å¯¼

```
ç´¢å¼•æŸ¥æ‰¾ç­–ç•¥:
  - å¦‚æœä¸ç¡®å®šç´¢å¼•çš„å®Œæ•´åç§°ï¼Œå…ˆä½¿ç”¨ search_indices æ¨¡ç³ŠæŸ¥æ‰¾
  - å½“å·¥å…·è¿”å›"ç´¢å¼•ä¸å­˜åœ¨"é”™è¯¯æ—¶ï¼Œç«‹å³ä½¿ç”¨ search_indices æŸ¥æ‰¾æ­£ç¡®çš„ç´¢å¼•
  - ç´¢å¼•åç§°é€šå¸¸åŒ…å«æ—¥æœŸã€é¡¹ç›®åã€ç¯å¢ƒç­‰ä¿¡æ¯
  - æ”¯æŒä½¿ç”¨é€šé…ç¬¦ï¼ˆå¦‚ logs-* åŒ¹é…æ‰€æœ‰ä»¥ logs- å¼€å¤´çš„ç´¢å¼•ï¼‰
```

### æ–°å¢çš„ç¤ºä¾‹

```
Example 1:
  Query: æŸ¥æ‰¾æ—¥å¿—ç›¸å…³çš„ç´¢å¼•
  Action: search_indices[log]

Example 2:
  Query: æŸ¥çœ‹backendç›¸å…³ç´¢å¼•çš„æ–‡æ¡£
  Action: search_indices[backend]
```

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç”¨æˆ·ä¸çŸ¥é“å‡†ç¡®ç´¢å¼•å

```
ç”¨æˆ·: "æŸ¥è¯¢è™šæ‹Ÿæœºç®¡ç†ç³»ç»Ÿçš„é”™è¯¯æ—¥å¿—"

Agent æ‰§è¡Œ:
  ğŸ’­ Thought: "è™šæ‹Ÿæœºç®¡ç†ç³»ç»Ÿ"å¯èƒ½å¯¹åº” vm_managerï¼Œå…ˆæœç´¢ç›¸å…³ç´¢å¼•
  âš™ï¸ Action: search_indices[vm_manager]
  ğŸ‘ï¸ Observation: 
    æ‰¾åˆ° 1 ä¸ªåŒ…å«å…³é”®è¯ 'vm_manager' çš„ç´¢å¼•ï¼š
    - backend-vm_manager-2025.11.04
      Health: green, Docs: 15234, Size: 2.3mb

  ğŸ’­ Thought: æ‰¾åˆ°äº†ç´¢å¼•ï¼Œç°åœ¨æŸ¥çœ‹å…¶ç»“æ„
  âš™ï¸ Action: get_index_mapping[backend-vm_manager-2025.11.04]
  ğŸ‘ï¸ Observation: å­—æ®µåŒ…å« M, L, T ç­‰

  ğŸ’­ Thought: æ„å»ºæœç´¢é”™è¯¯æ—¥å¿—çš„æŸ¥è¯¢
  âš™ï¸ Action: search_documents[{
    "index": "backend-vm_manager-2025.11.04",
    "query": {
      "term": {"L.keyword": "ERROR"}
    }
  }]
  ğŸ‘ï¸ Observation: æ‰¾åˆ° X æ¡é”™è¯¯æ—¥å¿—

  ğŸ“Š æœ€ç»ˆç­”æ¡ˆ: åœ¨è™šæ‹Ÿæœºç®¡ç†ç³»ç»Ÿä¸­æ‰¾åˆ° X æ¡é”™è¯¯æ—¥å¿—...
```

### ç¤ºä¾‹ 2: ç´¢å¼•åç§°é”™è¯¯çš„è‡ªåŠ¨æ¢å¤

```
ç”¨æˆ·: "æœç´¢logsç´¢å¼•çš„æ•°æ®"

Agent æ‰§è¡Œ:
  ğŸ’­ Thought: ç”¨æˆ·æåˆ°logsç´¢å¼•
  âš™ï¸ Action: get_index_mapping[logs]
  ğŸ‘ï¸ Observation: âŒ ç´¢å¼• 'logs' ä¸å­˜åœ¨ã€‚å»ºè®®ï¼šä½¿ç”¨ list_indices æŸ¥çœ‹å¯ç”¨ç´¢å¼•

  ğŸ’­ Thought: ç´¢å¼•ä¸å­˜åœ¨ï¼Œæˆ‘éœ€è¦æ‰¾åˆ°æ­£ç¡®çš„æ—¥å¿—ç´¢å¼•
  âš™ï¸ Action: search_indices[log]               â† è‡ªåŠ¨æ¢å¤
  ğŸ‘ï¸ Observation:
    æ‰¾åˆ° 3 ä¸ªåŒ…å«å…³é”®è¯ 'log' çš„ç´¢å¼•ï¼š
    - logs-2024-11 (æœ€æ–°)
    - logs-2024-10
    - application-logs

  ğŸ’­ Thought: ä½¿ç”¨æœ€æ–°çš„æ—¥å¿—ç´¢å¼•
  âš™ï¸ Action: search_documents[{"index": "logs-2024-11", ...}]
  ğŸ‘ï¸ Observation: æŸ¥è¯¢æˆåŠŸ

  ğŸ“Š æœ€ç»ˆç­”æ¡ˆ: åœ¨ logs-2024-11 ç´¢å¼•ä¸­æ‰¾åˆ°...
```

### ç¤ºä¾‹ 3: æ¢ç´¢æ—¶é—´èŒƒå›´çš„ç´¢å¼•

```
ç”¨æˆ·: "åˆ†æ11æœˆçš„æ‰€æœ‰æ—¥å¿—"

Agent æ‰§è¡Œ:
  ğŸ’­ Thought: éœ€è¦æ‰¾åˆ°æ‰€æœ‰11æœˆçš„æ—¥å¿—ç´¢å¼•
  âš™ï¸ Action: search_indices[2024-11]
  ğŸ‘ï¸ Observation:
    æ‰¾åˆ° 5 ä¸ªåŒ…å«å…³é”®è¯ '2024-11' çš„ç´¢å¼•ï¼š
    - logs-2024-11
    - backend-vm_manager-2025.11.04
    - api-logs-2024-11-05
    - user-events-2024-11
    - metrics-2024-11

  ğŸ’­ Thought: æ‰¾åˆ°äº†å¤šä¸ª11æœˆçš„ç´¢å¼•ï¼Œæˆ‘å¯ä»¥åˆ†åˆ«æŸ¥è¯¢æˆ–ä½¿ç”¨é€šé…ç¬¦
  âš™ï¸ Action: search_documents[{
    "index": "logs-2024-11,api-logs-2024-11-05",  // å¤šç´¢å¼•æŸ¥è¯¢
    "query": {...}
  }]
```

---

## âœ¨ ä¼˜åŒ–äº®ç‚¹

### 1. æ™ºèƒ½é”™è¯¯æ¢å¤
```
ç´¢å¼•ä¸å­˜åœ¨ â†’ è‡ªåŠ¨å»ºè®® â†’ Agent è‡ªåŠ¨ä½¿ç”¨ search_indices â†’ æ‰¾åˆ°æ­£ç¡®ç´¢å¼• â†’ ç»§ç»­æ‰§è¡Œ
```

### 2. æ¨¡ç³ŠåŒ¹é…èƒ½åŠ›
```
å…³é”®è¯: "log"
åŒ¹é…:
  âœ… logs-2024-11
  âœ… application-logs
  âœ… error-log-archive
  âœ… syslog
```

### 3. å‹å¥½çš„ç”¨æˆ·ä½“éªŒ
```
- ä¸éœ€è¦è®°ä½å®Œæ•´çš„ç´¢å¼•åç§°
- æ”¯æŒéƒ¨åˆ†å…³é”®è¯æœç´¢
- è‡ªåŠ¨æä¾›å»ºè®®
- æ™ºèƒ½æ¢å¤é”™è¯¯
```

---

## ğŸ”§ ç´¢å¼•å‘½åæ¨¡å¼è¯†åˆ«

### å¸¸è§çš„ç´¢å¼•å‘½åæ¨¡å¼

| æ¨¡å¼ | ç¤ºä¾‹ | æœç´¢å…³é”®è¯ |
|------|------|-----------|
| æ—¶é—´åºåˆ— | `logs-2024-11-04` | `2024-11`, `11-04` |
| é¡¹ç›®å‰ç¼€ | `backend-vm_manager-...` | `backend`, `vm_manager` |
| ç¯å¢ƒæ ‡è¯† | `prod-logs`, `dev-logs` | `prod`, `dev` |
| åŠŸèƒ½åˆ†ç±» | `error-logs`, `access-logs` | `error`, `access` |
| å¤åˆå‘½å | `app-name-env-date` | ä»»æ„éƒ¨åˆ† |

### æœç´¢ç­–ç•¥

**æŒ‰é¡¹ç›®**: `search_indices[é¡¹ç›®å]`
- `backend` â†’ backend-vm_manager-2025.11.04
- `frontend` â†’ frontend-logs-2024-11

**æŒ‰æ—¥æœŸ**: `search_indices[æ—¥æœŸ]`
- `2024-11` â†’ æ‰€æœ‰11æœˆçš„ç´¢å¼•
- `11.04` â†’ 11æœˆ4å·çš„ç´¢å¼•

**æŒ‰åŠŸèƒ½**: `search_indices[åŠŸèƒ½]`
- `error` â†’ error-logs, application-errors
- `access` â†’ access-logs, api-access

**æŒ‰ç¯å¢ƒ**: `search_indices[ç¯å¢ƒ]`
- `prod` â†’ prod-logs, production-data
- `dev` â†’ dev-logs, development-data

---

## âœ… ç¼–è¯‘éªŒè¯

```bash
âœ… go build -o jas-agent-server.exe cmd/server/main.go
   ç¼–è¯‘æˆåŠŸï¼
```

---

## ğŸŠ æ€»ç»“

**æ–°å¢åŠŸèƒ½**:
- âœ… `search_indices` å·¥å…· - æ¨¡ç³Šæœç´¢ç´¢å¼•
- âœ… æ™ºèƒ½é”™è¯¯æç¤º - ç´¢å¼•ä¸å­˜åœ¨æ—¶ç»™å‡ºå»ºè®®
- âœ… ç³»ç»Ÿæç¤ºè¯ä¼˜åŒ– - ç´¢å¼•æŸ¥æ‰¾ç­–ç•¥
- âœ… Few-shot ç¤ºä¾‹ - æ•™ Agent å¦‚ä½•æŸ¥æ‰¾ç´¢å¼•

**æ•ˆæœæå‡**:
- ğŸš€ ä¸éœ€è¦çŸ¥é“å‡†ç¡®çš„ç´¢å¼•åç§°
- ğŸš€ è‡ªåŠ¨ä»é”™è¯¯ä¸­æ¢å¤
- ğŸš€ æ”¯æŒå„ç§ç´¢å¼•å‘½åæ¨¡å¼
- ğŸš€ æ›´æ™ºèƒ½çš„ç´¢å¼•æ¢ç´¢

**ç°åœ¨ Elasticsearch Agent å¯ä»¥æ™ºèƒ½åœ°å¤„ç†ç´¢å¼•æŸ¥æ‰¾ï¼Œå³ä½¿ç”¨æˆ·ä¸çŸ¥é“å‡†ç¡®çš„ç´¢å¼•åç§°ï¼** ğŸ‰

